body {
    font-family: 'Inter', sans-serif;
}

.rubric-assessment-table tbody tr:nth-child(odd) th,
.rubric-assessment-table tbody tr:nth-child(odd) td {
    background-color: #f9fafb;
}

html.dark .rubric-assessment-table tbody tr:nth-child(odd) th,
html.dark .rubric-assessment-table tbody tr:nth-child(odd) td {
    background-color: rgba(148, 163, 184, 0.12);
}

.animate-fade-in { 
    animation: fadeIn 0.5s ease-in-out; 
}

@keyframes fadeIn { 
    from { opacity: 0; } 
    to { opacity: 1; } 
}

/* Evitar que el número en input[type=number] tenga flechas */
input[type=number]::-webkit-inner-spin-button, 
input[type=number]::-webkit-outer-spin-button { 
  -webkit-appearance: none; 
  margin: 0; 
}

input[type=number] {
    -moz-appearance: textfield;
}

.term-grades-table {
    border-collapse: separate;
    border-spacing: 0;
}

.term-grade-header-group {
    --term-grade-header-bg: #ffffff;
}

html.dark .term-grade-header-group {
    --term-grade-header-bg: #1f2937;
}

.term-grade-header-group th {
    background-color: var(--term-grade-header-bg);
}

.term-grade-header {
    white-space: nowrap;
}

.term-grade-toggle {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
    font-weight: inherit;
    color: inherit;
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
}

.term-grade-toggle i {
    flex-shrink: 0;
}

.term-grade-toggle:focus-visible {
    outline: 2px solid #3b82f6;
    outline-offset: 2px;
}

html.dark .term-grade-toggle:focus-visible {
    outline-color: #60a5fa;
}

.term-grade-group-label {
    display: inline-flex;
    align-items: center;
    gap: 0.35rem;
}

.term-grade-criteria-column[data-expanded="false"],
.term-grade-criteria-cell[data-expanded="false"] {
    display: none;
}

.term-grade-criteria-column[data-expanded="true"],
.term-grade-criteria-cell[data-expanded="true"] {
    display: table-cell;
}

.term-grade-header--criterion {
    box-shadow: inset 0 -3px 0 rgba(59, 130, 246, 0.35);
}

html.dark .term-grade-header--criterion {
    box-shadow: inset 0 -3px 0 rgba(96, 165, 250, 0.45);
}

.term-grade-header--competency,
.term-grade-header--group {
    box-shadow: inset 0 -3px 0 rgba(16, 185, 129, 0.35);
}

html.dark .term-grade-header--competency,
html.dark .term-grade-header--group {
    box-shadow: inset 0 -3px 0 rgba(16, 185, 129, 0.5);
}

.term-grade-header--final {
    box-shadow: inset 0 -3px 0 rgba(124, 58, 237, 0.35);
}

html.dark .term-grade-header--final {
    box-shadow: inset 0 -3px 0 rgba(167, 139, 250, 0.55);
}

.term-grade-separator {
    border-right: 2px solid rgba(15, 23, 42, 0.12);
}

html.dark .term-grade-separator {
    border-right: 2px solid rgba(148, 163, 184, 0.35);
}

.term-grade-tbody .term-grade-row {
    --term-grade-row-bg: #ffffff;
}

.term-grade-tbody .term-grade-row:nth-child(odd) {
    background-color: #f9fafb;
    --term-grade-row-bg: #f9fafb;
}

.term-grade-tbody .term-grade-row:nth-child(even) {
    background-color: #ffffff;
    --term-grade-row-bg: #ffffff;
}

html.dark .term-grade-tbody .term-grade-row:nth-child(odd) {
    background-color: rgba(148, 163, 184, 0.12);
    --term-grade-row-bg: rgba(148, 163, 184, 0.12);
}

html.dark .term-grade-tbody .term-grade-row:nth-child(even) {
    background-color: rgba(148, 163, 184, 0.06);
    --term-grade-row-bg: rgba(148, 163, 184, 0.06);
}

.term-grade-student-header,
.term-grade-student-cell {
    position: sticky;
    left: 0;
    background-color: var(--term-grade-row-bg, #ffffff);
    border-right: 2px solid rgba(15, 23, 42, 0.12);
    z-index: 20;
}

.term-grade-student-header {
    z-index: 40;
    background-color: var(--term-grade-header-bg, #ffffff);
}

html.dark .term-grade-student-header,
html.dark .term-grade-student-cell {
    background-color: var(--term-grade-row-bg, rgba(30, 41, 59, 0.85));
    border-right: 2px solid rgba(148, 163, 184, 0.35);
}

.term-grade-cell {
    background-color: transparent;
}

.term-grade-cell--criterion {
    box-shadow: inset 0 0 0 9999px rgba(59, 130, 246, 0.06);
}

html.dark .term-grade-cell--criterion {
    box-shadow: inset 0 0 0 9999px rgba(59, 130, 246, 0.18);
}

.term-grade-cell--competency {
    box-shadow: inset 0 0 0 9999px rgba(16, 185, 129, 0.08);
}

html.dark .term-grade-cell--competency {
    box-shadow: inset 0 0 0 9999px rgba(16, 185, 129, 0.2);
}

.term-grade-cell--final {
    box-shadow: inset 0 0 0 9999px rgba(124, 58, 237, 0.08);
}

html.dark .term-grade-cell--final {
    box-shadow: inset 0 0 0 9999px rgba(124, 58, 237, 0.22);
}

.term-grade-cell-content {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.term-grade-score-input {
    width: 3.5rem;
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
}

.term-grade-level-select {
    min-width: 4.25rem;
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
    background-color: #f1f5f9;
    color: #334155;
    border: 1px solid rgba(148, 163, 184, 0.35);
}

.term-grade-level-select[data-selected-level="none"],
.term-grade-level-select[data-selected-level=""] {
    background-color: #f1f5f9;
    color: #475569;
}

.term-grade-level-select[data-selected-level="AE"] {
    background-color: #dcfce7;
    color: #166534;
    border-color: #86efac;
}

.term-grade-level-select[data-selected-level="AN"] {
    background-color: #ccfbf1;
    color: #115e59;
    border-color: #5eead4;
}

.term-grade-level-select[data-selected-level="AS"] {
    background-color: #fef3c7;
    color: #92400e;
    border-color: #fcd34d;
}

.term-grade-level-select[data-selected-level="NA"] {
    background-color: #fed7aa;
    color: #c2410c;
    border-color: #fb923c;
}

.term-grade-level-select[data-selected-level="NP"] {
    background-color: #fecaca;
    color: #991b1b;
    border-color: #f87171;
}

html.dark .term-grade-level-select {
    background-color: rgba(148, 163, 184, 0.18);
    color: #e2e8f0;
    border-color: rgba(148, 163, 184, 0.35);
}

html.dark .term-grade-level-select[data-selected-level="none"],
html.dark .term-grade-level-select[data-selected-level=""] {
    background-color: rgba(148, 163, 184, 0.18);
    color: #e2e8f0;
}

html.dark .term-grade-level-select[data-selected-level="AE"] {
    background-color: rgba(34, 197, 94, 0.35);
    color: #bbf7d0;
    border-color: rgba(134, 239, 172, 0.6);
}

html.dark .term-grade-level-select[data-selected-level="AN"] {
    background-color: rgba(13, 148, 136, 0.4);
    color: #99f6e4;
    border-color: rgba(45, 212, 191, 0.6);
}

html.dark .term-grade-level-select[data-selected-level="AS"] {
    background-color: rgba(217, 119, 6, 0.4);
    color: #fde68a;
    border-color: rgba(251, 191, 36, 0.6);
}

html.dark .term-grade-level-select[data-selected-level="NA"] {
    background-color: rgba(234, 88, 12, 0.4);
    color: #fdba74;
    border-color: rgba(251, 146, 60, 0.6);
}

html.dark .term-grade-level-select[data-selected-level="NP"] {
    background-color: rgba(248, 113, 113, 0.45);
    color: #fecdd3;
    border-color: rgba(252, 165, 165, 0.65);
}

.term-grade-footnote {
    margin-left: 0.5rem;
}

#save-indicator.show {
    opacity: 1;
}

/* Estilos de impresión */
@media print {
    body {
        font-family: 'Times New Roman', serif;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }
    .no-print {
        display: none !important;
    }
    
    /* Oculta todo por defecto */
    body * {
        visibility: hidden;
    }
    
    /* Muestra solo el área imprimible y sus hijos */
    .printable-area, .printable-area * {
        visibility: visible;
        color: #000 !important;
    }
    
    /* --- INICIO DE LA CORRECCIÓN CLAVE --- */
    
    /* Resetea la altura y el overflow de los contenedores principales */
    .h-screen, .flex-1.flex.flex-col {
        height: auto !important;
        display: block !important; /* Rompe el layout flex para un flujo de documento normal */
    }

    #main-content {
        overflow-y: visible !important;
        height: auto !important;
    }
    
    /* Resetea la posición del área imprimible para que fluya en el documento */
    .printable-area {
        position: static !important; /* Permite que el contenido ocupe varias páginas */
        margin: 20mm; /* Añade márgenes de impresión estándar */
        padding: 0;
        width: auto !important;
        max-width: none !important;
        box-shadow: none !important;
        border: none !important;
        font-size: 12pt;
    }

    /* Elimina el scroll y la altura máxima del historial de anotaciones */
    #student-sheet-content .max-h-\[400px\] {
        max-height: none !important;
    }
    #student-sheet-content .overflow-y-auto {
        overflow: visible !important;
    }
    
    /* --- FIN DE LA CORRECCIÓN CLAVE --- */

    /* --- Estilos específicos para la Ficha del Alumnado --- */
    #student-sheet-content h2.print\:block {
        display: block !important;
        text-align: center;
        font-size: 22pt;
        margin-bottom: 40px;
        border-bottom: 1px solid #000;
        padding-bottom: 10px;
    }
    #student-sheet-content h3 {
        font-size: 16pt;
        font-weight: bold;
        margin-top: 25px;
        margin-bottom: 15px;
        border-bottom: 1px solid #ccc;
        padding-bottom: 5px;
        page-break-after: avoid; /* Evita saltos de página justo después de un título */
    }
    #student-sheet-content h4 { /* Títulos de clase en anotaciones */
        font-size: 14pt;
        font-weight: bold;
        margin-top: 20px;
        margin-bottom: 10px;
        page-break-after: avoid;
    }
    #student-sheet-content label {
        font-weight: bold;
        font-size: 14pt;
        margin-bottom: 8px;
        display: block;
    }
    #student-sheet-content input[type="text"],
    #student-sheet-content textarea {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        border: none !important;
        background: transparent !important;
        box-shadow: none !important;
        padding: 0 !important;
        width: 100%;
        font-family: 'Times New Roman', serif;
        font-size: 12pt;
        line-height: 1.5;
        resize: none;
        height: auto;
    }
    #student-sheet-content textarea {
        display: block;
        white-space: pre-wrap;
    }
    #student-sheet-content ul {
        list-style-position: inside;
        padding-left: 0;
    }
    #student-sheet-content li {
        background: transparent !important;
        padding: 4px 0 !important;
        border-bottom: 1px dotted #ccc;
    }
    #student-sheet-content li:last-child {
        border-bottom: none;
    }
    #student-sheet-content .p-3.bg-gray-50,
    #student-sheet-content .mb-4,
    #student-sheet-content .pl-6 {
        background: transparent !important;
        padding: 15px 0 !important;
        border: none !important;
    }
    #student-sheet-content .p-3.bg-gray-50:first-child {
        border-top: none;
    }
    #student-sheet-content .flex.items-center.gap-2.mb-2,
    #student-sheet-content .flex.items-center.gap-2.mb-3 {
        font-weight: bold;
    }
    #student-sheet-content .w-3.h-3.rounded-full, 
    #student-sheet-content .w-4.h-4.rounded-full,
    #student-sheet-content .absolute {
        display: none; /* Oculta puntos de color y decoraciones de la línea de tiempo */
    }
    #student-sheet-content .relative {
        page-break-inside: avoid; /* Intenta no cortar un bloque de anotación por la mitad */
    }

    /* --- Estilos para el Horario --- */
    #printable-schedule table {
        width: 100%;
        table-layout: fixed;
        font-size: 9pt;
        border-spacing: 0;
        border-collapse: collapse;
    }
    #printable-schedule th, #printable-schedule td {
        border: 1px solid #ccc;
        padding: 6px 4px;
        word-wrap: break-word;
    }
    #printable-schedule button, #printable-schedule div[style*="background-color"] {
        border: 1px solid #ccc !important;
        background-color: #f0f0f0 !important;
        color: #000 !important;
        font-size: 8pt !important;
        padding: 2px !important;
        min-height: 0 !important;
        white-space: normal !important;
        line-height: 1.2 !important;
        height: 100% !important;
    }
    #printable-schedule thead {
        display: none !important;
    }
    #printable-schedule button span.absolute {
        display: none !important;
    }
}
